# [장애 대응] {제목}

> **Version**: 1.0.0
> **Last Updated**: YYYY-MM-DD
> **Author**: {작성자}

---

## 📌 기술 키워드 (Technical Keywords)

| 카테고리 | 키워드 |
|---------|--------|
| **장애 유형** | `Service Outage`, `Performance Degradation`, `Data Inconsistency`, `Security Incident` |
| **인프라** | `AWS`, `EC2`, `RDS`, `ElastiCache`, `CloudWatch`, `ALB` |
| **기술 스택** | `Spring Boot`, `JPA`, `Redis`, `MySQL` |
| **모니터링** | `CloudWatch Alarm`, `Metrics`, `Log Analysis`, `APM` |
| **대응 패턴** | `Rollback`, `Circuit Breaker`, `Failover`, `Graceful Degradation` |

---

## 1. 장애 개요 (Incident Overview)

### 1.1 기본 정보
| 항목 | 내용 |
|------|------|
| **장애 등급** | Critical / Major / Minor |
| **발생 일시** | YYYY-MM-DD HH:MM:SS (KST) |
| **인지 일시** | YYYY-MM-DD HH:MM:SS (KST) |
| **복구 일시** | YYYY-MM-DD HH:MM:SS (KST) |
| **총 장애 시간** | X시간 X분 |
| **영향 범위** | 영향받은 서비스/기능/사용자 수 |
| **담당자** | 대응 담당자 이름 |

### 1.2 타임라인 요약
```
[HH:MM] 장애 발생
[HH:MM] 모니터링 알람 발생
[HH:MM] 장애 인지 (담당자)
[HH:MM] 초기 대응 시작
[HH:MM] 원인 파악 완료
[HH:MM] 긴급 조치 완료
[HH:MM] 서비스 복구 확인
[HH:MM] 장애 종료 선언
```

---

## 2. 장애 탐지 (Detection)

### 2.1 탐지 방법
- [ ] CloudWatch 알람
- [ ] APM 모니터링
- [ ] 사용자 신고
- [ ] 로그 분석
- [ ] 헬스체크 실패
- [ ] 기타: {설명}

### 2.2 알람/지표 정보
```yaml
Alarm Name: {알람 이름}
Metric: {메트릭 이름}
Threshold: {임계값}
Actual Value: {실제 값}
Duration: {지속 시간}
```

### 2.3 초기 증상
- 증상 1: {설명}
- 증상 2: {설명}
- 증상 3: {설명}

---

## 3. 영향 분석 (Impact Analysis)

### 3.1 서비스 영향
| 서비스/기능 | 영향 수준 | 영향 내용 |
|------------|----------|----------|
| 서비스 A | 전면 장애 / 부분 장애 / 성능 저하 | 구체적 영향 설명 |
| 서비스 B | 전면 장애 / 부분 장애 / 성능 저하 | 구체적 영향 설명 |

### 3.2 비즈니스 영향
- **영향받은 사용자 수**: 약 X명
- **실패한 요청 수**: 약 X건
- **매출 영향**: 추정 X원
- **SLA 영향**: X% 하락

### 3.3 연관 시스템 영향
```
[영향받은 시스템]
├── 직접 영향: 시스템 A, 시스템 B
└── 간접 영향: 시스템 C (연동 지연)
```

---

## 4. 근본 원인 분석 (Root Cause Analysis)

### 4.1 원인 요약
> 1-2문장으로 핵심 원인을 명확하게 기술

### 4.2 상세 원인 분석

#### 4.2.1 기술적 원인
```
[원인 계층 분석]
├── 직접 원인: {즉각적으로 장애를 유발한 원인}
├── 중간 원인: {직접 원인을 유발한 상위 원인}
└── 근본 원인: {궁극적인 원인 - 이것을 해결해야 재발 방지}
```

#### 4.2.2 5 Whys 분석
```
Why 1: 왜 장애가 발생했는가?
→ {답변}

Why 2: 왜 {답변1}이 발생했는가?
→ {답변}

Why 3: 왜 {답변2}이 발생했는가?
→ {답변}

Why 4: 왜 {답변3}이 발생했는가?
→ {답변}

Why 5: 왜 {답변4}이 발생했는가?
→ {근본 원인}
```

### 4.3 문제 코드/설정
```java
// 문제가 된 코드 또는 설정
// 주석으로 문제점 설명
```

### 4.4 관련 로그
```
[ERROR 로그 예시]
2025-XX-XX HH:MM:SS.SSS ERROR [thread-name] c.t.service.XxxService - Error message
    at com.tradingpt.service.XxxService.method(XxxService.java:XX)
    ...
```

---

## 5. 대응 조치 (Response Actions)

### 5.1 긴급 조치 (Emergency Response)
| 순서 | 시간 | 조치 내용 | 결과 |
|-----|------|----------|------|
| 1 | HH:MM | 조치 내용 | 성공/실패 |
| 2 | HH:MM | 조치 내용 | 성공/실패 |
| 3 | HH:MM | 조치 내용 | 성공/실패 |

### 5.2 복구 절차
```bash
# 1. 상태 확인
{확인 명령어}

# 2. 긴급 조치
{조치 명령어}

# 3. 서비스 재시작 (필요시)
{재시작 명령어}

# 4. 복구 확인
{확인 명령어}
```

### 5.3 롤백 수행 (해당시)
```bash
# 롤백 명령어
{롤백 절차}
```

---

## 6. 해결 방안 (Resolution)

### 6.1 단기 조치 (Quick Fix)
> 장애 즉시 대응을 위한 임시 조치

**Before (문제 코드):**
```java
// 문제가 된 코드
```

**After (수정 코드):**
```java
// 수정된 코드
```

### 6.2 장기 조치 (Permanent Fix)
> 근본 원인 해결을 위한 영구 조치

| 조치 항목 | 우선순위 | 담당자 | 예상 완료일 | 상태 |
|----------|---------|-------|-----------|------|
| 조치 1 | High | 담당자 | YYYY-MM-DD | 완료/진행중/예정 |
| 조치 2 | Medium | 담당자 | YYYY-MM-DD | 완료/진행중/예정 |
| 조치 3 | Low | 담당자 | YYYY-MM-DD | 완료/진행중/예정 |

---

## 7. 테스트 검증 결과 (Test Verification)

### 7.1 수정 전 상태 (Before)
```
[장애 재현 시나리오]
1. {재현 단계 1}
2. {재현 단계 2}
3. {예상 결과: 장애 발생}

[실제 결과]
- 에러 로그: {로그 내용}
- 응답 코드: {HTTP 상태 코드}
- 응답 시간: {시간}
```

### 7.2 수정 후 상태 (After)
```
[동일 시나리오 테스트]
1. {테스트 단계 1}
2. {테스트 단계 2}
3. {예상 결과: 정상 동작}

[실제 결과]
- 로그: {정상 로그}
- 응답 코드: 200 OK
- 응답 시간: {개선된 시간}
```

### 7.3 테스트 커버리지
| 테스트 유형 | 테스트 케이스 | 결과 | 비고 |
|------------|--------------|------|------|
| 단위 테스트 | 장애 시나리오 재현 테스트 | ✅ Pass | - |
| 통합 테스트 | E2E 흐름 검증 | ✅ Pass | - |
| 부하 테스트 | 동시 접속 X명 시나리오 | ✅ Pass | 응답시간 X% 개선 |
| 장애 복구 테스트 | Failover 시나리오 | ✅ Pass | 복구 시간 X초 |

### 7.4 모니터링 검증
```
[장애 후 모니터링 지표]
- Error Rate: X% → Y% (개선)
- Response Time (p99): Xms → Yms (개선)
- CPU Usage: X% → Y% (안정화)
- Memory Usage: X% → Y% (안정화)
```

---

## 8. 재발 방지 대책 (Prevention)

### 8.1 프로세스 개선
| 개선 영역 | 현재 상태 | 개선 내용 | 기대 효과 |
|----------|----------|----------|----------|
| 모니터링 | {현재} | {개선} | {효과} |
| 배포 프로세스 | {현재} | {개선} | {효과} |
| 코드 리뷰 | {현재} | {개선} | {효과} |
| 테스트 | {현재} | {개선} | {효과} |

### 8.2 모니터링/알람 강화
```yaml
# 신규 알람 설정
Alarm Name: {알람 이름}
Metric: {메트릭}
Threshold: {임계값}
Period: {기간}
Actions: {알람 액션}
```

### 8.3 체크리스트 추가
- [ ] 유사 장애 패턴 모니터링 항목 추가
- [ ] 배포 전 체크리스트 항목 추가
- [ ] 장애 대응 런북(Runbook) 업데이트
- [ ] 팀 내 장애 공유 및 교훈 전파

---

## 9. 교훈 및 회고 (Lessons Learned)

### 9.1 잘된 점 (What Went Well)
- 잘된 점 1: {설명}
- 잘된 점 2: {설명}

### 9.2 개선할 점 (What Could Be Improved)
- 개선점 1: {설명}
- 개선점 2: {설명}

### 9.3 액션 아이템
| 액션 | 담당자 | 기한 | 상태 |
|-----|-------|------|------|
| 액션 1 | 담당자 | YYYY-MM-DD | 대기/진행/완료 |
| 액션 2 | 담당자 | YYYY-MM-DD | 대기/진행/완료 |

---

## 10. 면접 Q&A (Interview Questions)

### Q1. 이 장애의 근본 원인은 무엇이었나요?
**A**: {장애의 기술적 근본 원인을 1-2문장으로 명확하게 설명}

**💡 포인트**: 직접 원인과 근본 원인을 구분하여 설명하고, 5 Whys 분석 결과를 언급

---

### Q2. 장애를 어떻게 탐지하고 대응했나요?
**A**: {탐지 방법, 초기 대응, 에스컬레이션 과정 설명}

**💡 포인트**:
- 모니터링 시스템 구성 (CloudWatch, APM 등)
- 알람 설정 기준 및 임계값
- 온콜(On-call) 대응 프로세스

---

### Q3. 장애 복구 시간(MTTR)을 줄이기 위해 어떤 노력을 했나요?
**A**: {복구 시간 단축을 위한 구체적인 노력과 결과}

**💡 포인트**:
- 자동화된 롤백 절차
- 런북(Runbook) 정비
- 장애 대응 훈련

---

### Q4. 재발 방지를 위해 어떤 조치를 취했나요?
**A**: {단기/장기 재발 방지 대책 설명}

**💡 포인트**:
- 기술적 조치 (코드 수정, 아키텍처 개선)
- 프로세스 개선 (배포 프로세스, 코드 리뷰)
- 모니터링 강화 (신규 알람, 대시보드)

---

### Q5. 이 장애 대응 경험에서 얻은 교훈은 무엇인가요?
**A**: {기술적 교훈과 프로세스 측면의 교훈}

**💡 포인트**:
- 기술적 배움 (특정 기술의 특성, 장단점)
- 팀워크 및 커뮤니케이션
- 장애 대응 문화 개선

---

### Q6. 유사한 장애를 예방하기 위한 시스템 설계 원칙은?
**A**: {장애 경험을 바탕으로 한 설계 원칙}

**💡 포인트**:
- Fail-fast 원칙
- Circuit Breaker 패턴
- Graceful Degradation
- Chaos Engineering

---

## 📎 참고 자료 (References)

### 관련 문서
- [관련 이슈 문서 1](./링크)
- [관련 장애 보고서](./링크)
- [시스템 아키텍처 문서](./링크)

### 외부 참조
- [AWS Best Practices for Incident Response](https://aws.amazon.com/)
- [SRE Book - Incident Management](https://sre.google/)

---

## 📝 변경 이력 (Change Log)

| 버전 | 날짜 | 작성자 | 변경 내용 |
|------|------|--------|----------|
| 1.0.0 | YYYY-MM-DD | 작성자 | 최초 작성 |
